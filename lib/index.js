"use strict";var e=require("path"),n=require("fs");function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var r=t(e);var s=(e,n)=>0===e.files.length&&0===e.folders.length?"":(e=>"---\nsidebar: false\ntitle: "+e.title+"\n---\n## 该章节包含以下内容")({title:n})+"\n  \n  "+e.files.map((e=>`\n- [${e.replace(".md","")}](${e})\n\n  `)).join("")+e.folders.map((e=>{const n=e.children.map((n=>`\n- [${n.replace(".md","")}](${e.link+"/"+n})\n\n  `)).join("");return`\n#### [${e.title}专题](${e.link})\n    `+n})).join("");const i=(e,t=[])=>{const s=n.readdirSync(e).filter((s=>{const i=n.statSync(r.default.join(e,s)),o=s.slice(s.lastIndexOf(".")+1);return i.isFile()&&t.includes(o)&&l(s)}));return s.sort(),s},l=e=>"readme.md"!==e.toLocaleLowerCase(),o=(e=".",t=[])=>{const s=n.readdirSync(e),i=[];return s.forEach((s=>{const l=r.default.join(e,s);n.statSync(l).isDirectory()&&!t.includes(s)&&i.push(l)})),i};var c=i,d=o,a=(e,t=[])=>{const l={files:i(e,["md"]),folders:o(e,t).map((n=>({title:n.substring(n.lastIndexOf("/")+1),link:n.replace(e,"."),children:i(n,["md"])||[]})))},c=s(l,e.substring(e.lastIndexOf("/")+1)),d=r.default.join(e,"./README.md");n.writeFileSync(d,c)};const u=(e,n=[],t="/",r=[])=>{const s=d(e,n);return[...m(e,t),...s.map((e=>{const s=e.substring(e.lastIndexOf("/")+1),i=t+s+"/";if(a(e),f(e,n)){const t=d(e,n).map((e=>{const n=e.substring(e.lastIndexOf("/")+1),t=i+n+"/";return a(e),{text:n,link:t}}));return{text:s,link:i,children:r.includes(s)?t:[]}}return{text:s,link:i,children:r.includes(s)?m(e,i):[]}}))]},f=(e,n=[])=>0!==d(e,n).length,m=(e,n="")=>{const t=c(e,["md"]);return a(e),t.map((e=>n+e))};module.exports=function(n={subNav:{show:[]},ignore:{folders:[],files:[]}}){return((e,n=[],t=[])=>d(e,n).map((e=>{const r=e.substring(e.lastIndexOf("/")+1),s=e.substring(e.lastIndexOf("/"))+"/";return f(e,n)?{text:r,link:s,children:u(e,n,s,t)}:{text:r,children:m(e,s)}})))(e.resolve(process.cwd(),"docs"),n.ignore.folders,n.subNav.show)};
